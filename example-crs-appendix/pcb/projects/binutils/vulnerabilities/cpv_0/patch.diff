diff --git a/gas/read.c b/gas/read.c
index 58b2fd12517..31b89b7cbc8 100644
--- a/gas/read.c
+++ b/gas/read.c
@@ -3137,6 +3137,8 @@ do_repeat (size_t count, const char *start, const char *end,
       return;
     }
 
+  sb_terminate (&one);
+
   if (expander != NULL && !*expander && strstr (one.ptr, "\\+") != NULL)
     {
       /* The 3 here and below are arbitrary, added in an attempt to limit
@@ -3150,8 +3152,7 @@ do_repeat (size_t count, const char *start, const char *end,
 
 	  sb_build (&processed, one.len + 3);
 
-	  for (ptr = one.ptr;
-	       (bs = memchr (ptr, '\\', one.ptr + one.len - ptr)) != NULL; )
+	  for (ptr = one.ptr; (bs = strchr (ptr, '\\')) != NULL; )
 	    {
 	      sb_add_buffer (&processed, ptr, bs - ptr);
 	      switch (bs[1])
@@ -3182,7 +3183,7 @@ do_repeat (size_t count, const char *start, const char *end,
 		}
 	    }
 
-	  sb_add_buffer (&processed, ptr, one.ptr + one.len - ptr);
+	  sb_add_string (&processed, ptr);
 
 	  sb_add_sb (&many, &processed);
 	  sb_kill (&processed);
