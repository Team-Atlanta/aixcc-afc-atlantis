description: |-
  Regex patterns compiled with user input causing errors or memory exhaustion.

  Find: Pattern.compile() using user input or CANON_EQ flag, vulnerable patterns with user input, and String regex methods.
  ```java
  String userPattern = request.getParameter("pattern");
  Pattern.compile(userPattern);  // BUG: malicious patterns
  Pattern.compile(userInput, Pattern.CANON_EQ);  // BUG: memory exhaustion

  // Vulnerable pattern with user input
  String userInput = request.getParameter("input");
  Pattern.compile("(a+)+").matcher(userInput).matches();  // BUG: catastrophic backtracking

  // String methods
  String text = "data";
  text.replaceAll(userPattern, "replacement");  // BUG: regex in String method
  text.split(userPattern);  // BUG: regex in split
  ```

exploit: |-
  1. Locate regex compilation with user input
  2. Inject invalid pattern, use CANON_EQ with combining marks, or exploit vulnerable patterns

  ```java
  Pattern.compile("[");  // Unclosed character class
  // OR
  Pattern.compile("\u0300\u0300\u0300", Pattern.CANON_EQ);  // Memory exhaustion
  // OR
  Pattern.compile("(a+)+").matcher("aaaaaaaaaaaaaaaaaaaaX").matches();  // Catastrophic backtracking
  // OR
  "test".replaceAll("[", "x");  // String method variant
  ```
