# CRS Patch Generation

## CRS Patch Generation API

The template code of CRS Patch Generation server is autogenerated from [API docs](/docs/api/crs-patch.json) by using [fastapi-codegen](https://github.com/GeorgeDimi/FastAPI_OpenAPI/tree/main).

The instructions have been reproduced below:
```bash
$ uv sync --dev
$ uv run fastapi-codegen --input docs/api/crs-patch.json --output crs_patch
```

## Build and Run Instructions

### 1. Fill `.env` from the example environment file `example.env`.

### 2. Building the Docker Image
To build the Docker image, run the following command from the root directory (./crete):
```bash
./docker-build.sh
```
This will create a Docker image with all necessary dependencies and configurations.

### 3. (Optional) Pushing the Docker Image
If you want to push the image to a Docker registry (e.g., GitHub Container Registry), use:
```bash
./docker-img-push.sh <REGISTRY> <IMAGE_VERSION>
```
Example:
```bash
./docker-img-push.sh ghcr.io/team-atlanta latest
```

### 4. Running the Service Locally
To run the CRS service locally, use the `run.sh` script with optional parameters:
```bash
./run.sh [-t IMAGE_TAG] [-o OUTPUT_DIR] [-p PORT]
```

Parameters:
- `-t`: Docker image tag (default: ghcr.io/team-atlanta/crs-patch)
- `-o`: Output directory for tarballs (default: ./cp_tarballs/mock-c-full)
- `-p`: Port number (default: 8080)

Example:
```bash
./run.sh -t ghcr.io/team-atlanta/crs-patch:latest -o ./cp_tarballs/mock-c-full -p 8080
```
