diff --git a/src/http/ngx_http_request.c b/src/http/ngx_http_request.c
index 3cc9933..81ef047 100644
--- a/src/http/ngx_http_request.c
+++ b/src/http/ngx_http_request.c
@@ -1255,12 +1255,14 @@ ngx_http_process_request_uri(ngx_http_request_t *r)
 
     if (r->complex_uri || r->quoted_uri || r->empty_path_in_uri) {
 
-        if(!r->empty_path_in_uri){
-            r->uri.data = ngx_pnalloc(r->pool, r->uri.len);
-            if (r->uri.data == NULL) {
-                ngx_http_close_request(r, NGX_HTTP_INTERNAL_SERVER_ERROR);
-                return NGX_ERROR;
-            }
+        if (r->empty_path_in_uri) {
+            r->uri.len++;
+        }
+
+        r->uri.data = ngx_pnalloc(r->pool, r->uri.len);
+        if (r->uri.data == NULL) {
+            ngx_http_close_request(r, NGX_HTTP_INTERNAL_SERVER_ERROR);
+            return NGX_ERROR;
         }
 
         cscf = ngx_http_get_module_srv_conf(r, ngx_http_core_module);
