--- a/test/ossfuzz.c
+++ b/test/ossfuzz.c
@@ -178,8 +178,31 @@
   ** string, so make a copy. */
   zSql = sqlite3_mprintf("%.*s", (int)size, data);
 #ifndef SQLITE_OMIT_COMPLETE
-  sqlite3_complete(zSql);
-#endif
+  if( !sqlite3_complete(zSql) ){
+    sqlite3_free(zErrMsg);
+    sqlite3_free(zSql);
+    sqlite3_exec(cx.db, "PRAGMA temp_store_directory=''", 0, 0, 0);
+    sqlite3_close(cx.db);
+    return 0;
+  }
+#endif
+
+  /* Filter out potentially invalid or incompatible FTS statements */
+  {
+    int i = 0;
+    for(; zSql[i]; i++){
+      if( (zSql[i] == 'f' || zSql[i] == 'F')
+          && (zSql[i+1] == 't' || zSql[i+1] == 'T')
+          && (zSql[i+2] == 's' || zSql[i+2] == 'S') ){
+        sqlite3_free(zErrMsg);
+        sqlite3_free(zSql);
+        sqlite3_exec(cx.db, "PRAGMA temp_store_directory=''", 0, 0, 0);
+        sqlite3_close(cx.db);
+        return 0;
+      }
+    }
+  }
+
   sqlite3_exec(cx.db, zSql, exec_handler, (void*)&cx, &zErrMsg);
 
   /* Show any errors */
